<!DOCTYPE html><html lang="zh-CN"><head><meta name="baidu-site-verification" content="WJEAqh4Drc" /><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="jverson's blog | java | web | Jverson"><title>使用编辑距离计算文本相似度 | 墨言</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.1"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/3.0.3/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">使用编辑距离计算文本相似度</h1><a id="logo" href="/.">墨言</a><p class="description">LIFE IS SIMPLE, LOVE SMILE AND CODE</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="http://album.jverson.com/"><i class="fa fa-picture-o"> 相册</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">使用编辑距离计算文本相似度</h1><div class="post-meta">Jun 28, 2018<span> | </span><span class="category"><a href="/categories/Coding/">Coding</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-disqus-identifier="2018/06/28/edit-distance/" href="/2018/06/28/edit-distance/#disqus_thread" class="disqus-comment-count"></a><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Minimum-Edit-Distance"><span class="toc-number">1.</span> <span class="toc-text">Minimum Edit Distance</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Computing-Minimum-Edit-Distance"><span class="toc-number">2.</span> <span class="toc-text">Computing Minimum Edit Distance</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Common-Algorithm-Implementation"><span class="toc-number">3.</span> <span class="toc-text">Common Algorithm Implementation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Wagner–Fischer-algorithm-Implementation"><span class="toc-number">4.</span> <span class="toc-text">Wagner–Fischer algorithm Implementation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Usage"><span class="toc-number">5.</span> <span class="toc-text">Usage</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#References"><span class="toc-number">6.</span> <span class="toc-text">References</span></a></li></ol></div></div><div class="post-content"><p>在语音交互中有这样一种场景：给出一组候选项，希望找出与用户输入相似度最高的一项。例如给用户推荐商品（例如手机）的同时会提供一组品牌的筛选项，当用户输入了“选华为的”，这时就需要匹配到“华为（HUAWEI）”这个候选项。用户输入的多样性及 ASR(Automatic Speech Recognition) 的准确率增加了这个问题的复杂性，这里使用 <a href="https://en.wikipedia.org/wiki/Edit_distance" target="_blank" rel="external">编辑距离 Edit distance</a> 可以很好的解决这个问题。</p>
<a id="more"></a>
<h2 id="Minimum-Edit-Distance"><a href="#Minimum-Edit-Distance" class="headerlink" title="Minimum Edit Distance"></a>Minimum Edit Distance</h2><p>Minimum Edit Distance （最小编辑距离），是用來计算两个字符串的相似程度，被广泛用於拼字校正、或是计算两个 DNA 序列的相似程度。它的定义如下，</p>
<p>给定 2 个字符串 a, b。 编辑距离是将 a 转换为 b 的最少操作次数，操作只允许如下 3 种：</p>
<ul>
<li>插入一个字符，例如：<code>fj -&gt; fxj</code></li>
<li>删除一个字符，例如：<code>fxj -&gt; fj</code></li>
<li>替换一个字符，例如：<code>jxj -&gt; fyj</code></li>
</ul>
<h2 id="Computing-Minimum-Edit-Distance"><a href="#Computing-Minimum-Edit-Distance" class="headerlink" title="Computing Minimum Edit Distance"></a>Computing Minimum Edit Distance</h2><p>编辑距离计算是一个典型的递归问题，假设</p>
<ul>
<li>字符串 a, 共 m 位，从 <code>a[1]</code> 到 <code>a[m]</code>；</li>
<li>字符串 b, 共 n 位，从 <code>b[1]</code> 到 <code>b[n]</code>；</li>
<li><code>d[i][j]</code> 表示字符串 <code>a[1]-a[i]</code> 转换为 <code>b[1]-b[j]</code> 的编辑距离；</li>
</ul>
<p>那么有如下递归规律（<code>a[i]</code> 和 <code>b[j]</code> 分别是字符串 a 和 b 的最后一位）：</p>
<ol>
<li>当 <code>a[i]</code> 等于 <code>b[j]</code> 时，<code>d[i][j] = d[i-1][j-1]</code>, 比如 <code>fxy -&gt; fay</code> 的编辑距离等于 <code>fx -&gt; fa</code> 的编辑距离</li>
<li>当 <code>a[i]</code> 不等于 <code>b[j]</code> 时，<code>d[i][j]</code> 等于如下 3 项的最小值：<ul>
<li><code>d[i-1][j] + 1</code>（删除 a[i]）， 比如 fxy -&gt; fab 的编辑距离 = fx -&gt; fab 的编辑距离 + 1</li>
<li><code>d[i][j-1] + 1</code>（插入 b[j])， 比如 fxy -&gt; fab 的编辑距离 = fxyb -&gt; fab 的编辑距离 + 1 = fxy -&gt; fa 的编辑距离 + 1</li>
<li><code>d[i-1][j-1] + 1</code>（将 a[i] 替换为 b[j]）， 比如 fxy -&gt; fab 的编辑距离 = fxb -&gt; fab 的编辑距离 + 1 = fx -&gt; fa 的编辑距离 + 1</li>
</ul>
</li>
</ol>
<p>递归边界：</p>
<ol>
<li><code>a[i][0] = i</code>, b 字符串为空，表示将 a[1]-a[i] 全部删除，所以编辑距离为 i</li>
<li><code>a[0][j] = j</code>, a 字符串为空，表示 a 插入 b[1]-b[j]，所以编辑距离为 j</li>
</ol>
<p>使用公式表示如下：</p>
<p><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/1deeeaebff36dc4bdc79778bcafe0ec17ce63f83" alt=""></p>
<h2 id="Common-Algorithm-Implementation"><a href="#Common-Algorithm-Implementation" class="headerlink" title="Common Algorithm Implementation"></a>Common Algorithm Implementation</h2><p>按照上面递归思路实现很简单，代码如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">editDistance</span><span class="params">(String str1, String str2)</span> </span>&#123;</div><div class="line">    Preconditions.checkNotNull(str1);</div><div class="line">    Preconditions.checkNotNull(str2);</div><div class="line"></div><div class="line">    <span class="keyword">int</span> len1 = str1.length();</div><div class="line">    <span class="keyword">int</span> len2 = str2.length();</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (len1 == <span class="number">0</span>) &#123;</div><div class="line">        <span class="keyword">return</span> len2;</div><div class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (len2 == <span class="number">0</span>) &#123;</div><div class="line">		<span class="keyword">return</span> len1;</div><div class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span> (str1.charAt(len1-<span class="number">1</span>) == str2.charAt(len2-<span class="number">1</span>)) &#123;</div><div class="line">		<span class="keyword">return</span> editDistance(str1.substring(<span class="number">0</span>, len1-<span class="number">1</span>), str2.substring(<span class="number">0</span>, len2-<span class="number">1</span>));</div><div class="line">	&#125;<span class="keyword">else</span> &#123;</div><div class="line">		<span class="keyword">return</span> <span class="number">1</span> + min(editDistance(str1.substring(<span class="number">0</span>, len1), str2.substring(<span class="number">0</span>, len2-<span class="number">1</span>)), </div><div class="line">				       min(editDistance(str1.substring(<span class="number">0</span>, len1-<span class="number">1</span>), str2.substring(<span class="number">0</span>, len2)), </div><div class="line">						   editDistance(str1.substring(<span class="number">0</span>, len1-<span class="number">1</span>), str2.substring(<span class="number">0</span>, len2-<span class="number">1</span>))));</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Wagner–Fischer-algorithm-Implementation"><a href="#Wagner–Fischer-algorithm-Implementation" class="headerlink" title="Wagner–Fischer algorithm Implementation"></a>Wagner–Fischer algorithm Implementation</h2><p>我们不难发现上面递归的方法时间复杂度和空间复杂度都是 <code>O(mn)</code>，效率很低！而使用一种基于动态规划思想的算法 <a href="https://en.wikipedia.org/wiki/Wagner–Fischer_algorithm" target="_blank" rel="external">Wagner–Fischer algorithm</a> 则可以将时间复杂度降低到 <code>O(mn)</code>，其中 s 为编辑距离，并且空间复杂度也可以降为 O(s)。</p>
<p>前面的方法是从后往前算的，比如我想知道 <code>a[i][j]</code> 我可能需要知道 <code>a[i-1][j-1]</code>，而另一种思路是从前往后算，先算出各个子问题，然后根据子问题，计算出原问题，下面就来详细解释一下：</p>
<p>以字符串 a = “fxy”, b = “fab” 为例</p>
<ol>
<li><p>首先建立一个矩阵，用来存放子问题及原问题的编辑距离，并将递归边界在矩阵中填好，如下：<br><img src="http://7xry05.com1.z0.glb.clouddn.com/201808281955_879.png" alt=""></p>
</li>
<li><p>然后计算 i = 1, j = 1 所对应的编辑距离<br>比较 a[i] 和 b[j] 是否相等然后根据递归规律算出这个值，比如在这种情况下 a[i] = f 和 b[j] = f, 那么 <code>d[i][j]</code> 就等于 <code>d[i-1][j-1]</code> 等于 0<br>然后计算 i = 1, j = 2 直到算出 i = 3, j = 3, 原问题的编辑距离就等于 <code>d[3][3]</code>，最终矩阵如下：<br><img src="http://7xry05.com1.z0.glb.clouddn.com/201808282003_296.png" alt=""></p>
</li>
</ol>
<p>代码实现如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">editDistance2</span><span class="params">(String str1, String str2)</span> </span>&#123;</div><div class="line">    Preconditions.checkNotNull(str1);</div><div class="line">    Preconditions.checkNotNull(str2);</div><div class="line"></div><div class="line">    <span class="keyword">int</span> len1 = str1.length();</div><div class="line">    <span class="keyword">int</span> len2 = str2.length();</div><div class="line"></div><div class="line">    <span class="comment">// len1+1, len2+1, because finally return dp[len1][len2]</span></div><div class="line">    <span class="keyword">int</span>[][] dp = <span class="keyword">new</span> <span class="keyword">int</span>[len1 + <span class="number">1</span>][len2 + <span class="number">1</span>];</div><div class="line"></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= len1; i++) &#123;</div><div class="line">        dp[i][<span class="number">0</span>] = i;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= len2; j++) &#123;</div><div class="line">        dp[<span class="number">0</span>][j] = j;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//iterate though, and check last char</span></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len1; i++) &#123;</div><div class="line">        <span class="keyword">char</span> c1 = lhs.charAt(i);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; len2; j++) &#123;</div><div class="line">            <span class="keyword">char</span> c2 = rhs.charAt(j);</div><div class="line">            <span class="comment">//if last two chars equal</span></div><div class="line">            <span class="keyword">if</span> (c1 == c2) &#123;</div><div class="line">                <span class="comment">//update dp value for +1 length</span></div><div class="line">                dp[i + <span class="number">1</span>][j + <span class="number">1</span>] = dp[i][j];</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">            	dp[i + <span class="number">1</span>][j + <span class="number">1</span>] = <span class="number">1</span> + min(dp[i+<span class="number">1</span>][j], min(dp[i][j+<span class="number">1</span>], dp[i][j])); <span class="comment">// 这里不需要递归实现了</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span>  dp[len1][len2]; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>明显时间复杂度已经降下来了，因为从前往后算的时候初始值可以直接得到，因此计算下一个元素的时候就不必在像之前一样递归去求，直接使用初始值进行计算，而从后往前算则只能通过递归实现。</p>
<p>另外在实际应用中编辑距离的绝对值并不好衡量相似程度，而一般是通过编辑距离除以两个字符串的最大长度得到一个归一化的相似度值，即 <code>1.0 - ((double) dp[len1][len2]) / max(len1, len2)</code>，依次计算输入与候选项的相似度，取最高值并判断该值是否高于设定的阈值（实际应用中设置的是 0.3），满足条件则会返回匹配项，不满足则认为没有命中候选项。</p>
<h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><p>中文转化为拼音后计算编辑距离能够有效解决同音词、相似发音词、发音不标准等特殊情况下的语音识别。但是注意编辑距离明显对长句和短句之间的相似度计算偏差很大，因此该方法主要针对长度相近，从一组候选项中进行最佳匹配的场景。</p>
<p>这是 Github 上一个 <a href="https://github.com/belerweb/pinyin4j" target="_blank" rel="external">Java 中文转拼音</a>的开源实现，用起来还不错，可以参考。</p>
<p>添加依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.belerweb<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pinyin4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div></pre></td></tr></table></figure>
<p>封装 Java 工具类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PinYinUtil</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> HanyuPinyinOutputFormat format = <span class="keyword">new</span> HanyuPinyinOutputFormat();</div><div class="line"></div><div class="line">    <span class="keyword">static</span> &#123;</div><div class="line">        format.setCaseType(HanyuPinyinCaseType.LOWERCASE);</div><div class="line">        format.setToneType(HanyuPinyinToneType.WITHOUT_TONE);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// 转换单个字符</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">getCharacterPinYin</span><span class="params">(<span class="keyword">char</span> c)</span> </span>&#123;</div><div class="line">        String[] pinyin = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            pinyin = PinyinHelper.toHanyuPinyinStringArray(c, format);</div><div class="line">        &#125; <span class="keyword">catch</span> (BadHanyuPinyinOutputFormatCombination e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// 如果c不是汉字，toHanyuPinyinStringArray会返回null</span></div><div class="line">        <span class="keyword">if</span> (pinyin == <span class="keyword">null</span>)</div><div class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line"></div><div class="line">        <span class="comment">// 只取一个发音，如果是多音字，仅取第一个发音</span></div><div class="line">        <span class="keyword">return</span> pinyin[<span class="number">0</span>];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// 转换单个字符,返回所有拼音</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title">getCharacterPinYins</span><span class="params">(<span class="keyword">char</span> c)</span> </span>&#123;</div><div class="line">        String[] pinyin = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            pinyin = PinyinHelper.toHanyuPinyinStringArray(c, format);</div><div class="line">        &#125; <span class="keyword">catch</span> (BadHanyuPinyinOutputFormatCombination e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// 如果c不是汉字，toHanyuPinyinStringArray会返回null</span></div><div class="line">        <span class="keyword">if</span> (pinyin == <span class="keyword">null</span>)</div><div class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> Arrays.asList(pinyin);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// 转换一个字符串</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getStringPinYin</span><span class="params">(String str)</span> </span>&#123;</div><div class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</div><div class="line">        String tempPinyin = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; str.length(); ++i) &#123;</div><div class="line">            tempPinyin = getCharacterPinYin(str.charAt(i));</div><div class="line">            <span class="keyword">if</span> (tempPinyin == <span class="keyword">null</span>) &#123;</div><div class="line">                <span class="comment">// 如果str.charAt(i)非汉字，则保持原样</span></div><div class="line">                sb.append(str.charAt(i));</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                sb.append(tempPinyin);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> sb.toString();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isPinYinSame</span><span class="params">(String text1, String text2)</span> </span>&#123;</div><div class="line">        <span class="keyword">boolean</span> isSame = <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">if</span> (StringUtils.isNotBlank(text1) &amp;&amp; StringUtils.isNotBlank(text2) &amp;&amp; text1.length() == text2.length()) &#123;</div><div class="line">            <span class="keyword">int</span> len = text1.length();</div><div class="line">            List&lt;String&gt; pinYinList1 = <span class="keyword">null</span>;</div><div class="line">            List&lt;String&gt; pinYinList2 = <span class="keyword">null</span>;</div><div class="line">            Character char1 = <span class="keyword">null</span>;</div><div class="line">            Character char2 = <span class="keyword">null</span>;</div><div class="line">            <span class="keyword">boolean</span> isAllSame = <span class="keyword">true</span>;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</div><div class="line">                char1 = text1.charAt(i);</div><div class="line">                char2 = text2.charAt(i);</div><div class="line">                pinYinList1 = getCharacterPinYins(char1);</div><div class="line">                pinYinList2 = getCharacterPinYins(char2);</div><div class="line">                <span class="keyword">boolean</span> isMatch = <span class="keyword">false</span>;</div><div class="line">                <span class="keyword">if</span> (pinYinList1 != <span class="keyword">null</span> &amp;&amp; pinYinList2 != <span class="keyword">null</span>) &#123;</div><div class="line">                    <span class="keyword">for</span> (String pinyin : pinYinList1) &#123;</div><div class="line">                        <span class="keyword">if</span> (pinYinList2.contains(pinyin)) &#123;</div><div class="line">                            isMatch = <span class="keyword">true</span>;</div><div class="line">                            <span class="keyword">break</span>;</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (pinYinList1 == <span class="keyword">null</span> &amp;&amp; pinYinList2 == <span class="keyword">null</span> &amp;&amp; char1.equals(char2)) &#123;</div><div class="line">                    isMatch = <span class="keyword">true</span>;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">if</span> (!isMatch) &#123;</div><div class="line">                    isAllSame = <span class="keyword">false</span>;</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (isAllSame) &#123;</div><div class="line">                isSame = <span class="keyword">true</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> isSame;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ol>
<li><a href="https://en.wikipedia.org/wiki/Edit_distance" target="_blank" rel="external">Wikipedia - Edit distance</a></li>
<li><a href="https://en.wikipedia.org/wiki/Wagner%E2%80%93Fischer_algorithm" target="_blank" rel="external">Wikipedia - Wagner–Fischer algorithm</a></li>
<li><a href="https://www.dreamxu.com/books/dsa/dp/edit-distance.html" target="_blank" rel="external">Gitbook - edit-distance</a></li>
<li><a href="http://ai.baidu.com/docs#/ASR-Tool-diff/top" target="_blank" rel="external">百度AI开放平台 - 拼音相似度比较</a></li>
</ol>
</div><script type="text/javascript" src="/js/share.js?v=0.0.1" async></script><a data-url="https://jverson.com/2018/06/28/edit-distance/" data-id="cjm1vcdkf002mzwteogwqnzjq" class="article-share-link">分享到</a><div class="tags"><a href="/tags/Algorithm/">Algorithm</a></div><div class="post-nav"><a href="/2018/05/21/add-https-to-blog/" class="pre">博客域名升级 Https</a><a href="/2018/08/10/miniprogram/" class="next">上手微信小程序开发</a></div><div id="disqus_thread"><script>var disqus_shortname = 'jverson';
var disqus_identifier = '2018/06/28/edit-distance/';
var disqus_title = '使用编辑距离计算文本相似度';
var disqus_url = 'https://jverson.com/2018/06/28/edit-distance/';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//jverson.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><a href="https://jverson.com/"><img src="https://wx4.sinaimg.cn/mw1024/74993f9ely1fuptmctad9j20cg0cg40p.jpg" alt="" border="0" style="margin-top:15px; border-radius: 300px;" width="180px"; height="180px"; ></a></div><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://jverson.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-book"> 笔记</i></div><ul></ul><a href="thinking-in-java/" title="Thinking in Java" target="_blank">Thinking in Java</a><ul></ul><a href="https://jverson.com/spring-boot-demo/" title="Spring Boot" target="_blank">Spring Boot</a></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Coding/">Coding</a><span class="category-list-count">27</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Network/">Network</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Thinking/">Thinking</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tools/">Tools</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Travelling/">Travelling</a><span class="category-list-count">2</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/并发/" style="font-size: 15px;">并发</a> <a href="/tags/GitHub/" style="font-size: 15px;">GitHub</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/Algorithm/" style="font-size: 15px;">Algorithm</a> <a href="/tags/Java8/" style="font-size: 15px;">Java8</a> <a href="/tags/Basic/" style="font-size: 15px;">Basic</a> <a href="/tags/Https/" style="font-size: 15px;">Https</a> <a href="/tags/Cache/" style="font-size: 15px;">Cache</a> <a href="/tags/Alfred-Markdown/" style="font-size: 15px;">Alfred Markdown</a> <a href="/tags/AutoHotkey/" style="font-size: 15px;">AutoHotkey</a> <a href="/tags/Concurrent/" style="font-size: 15px;">Concurrent</a> <a href="/tags/JavaScript/" style="font-size: 15px;">JavaScript</a> <a href="/tags/Blog/" style="font-size: 15px;">Blog</a> <a href="/tags/Frontend/" style="font-size: 15px;">Frontend</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/Tools/" style="font-size: 15px;">Tools</a> <a href="/tags/Hadoop/" style="font-size: 15px;">Hadoop</a> <a href="/tags/Travelling/" style="font-size: 15px;">Travelling</a> <a href="/tags/Git/" style="font-size: 15px;">Git</a> <a href="/tags/network/" style="font-size: 15px;">network</a> <a href="/tags/AI/" style="font-size: 15px;">AI</a> <a href="/tags/Summary/" style="font-size: 15px;">Summary</a> <a href="/tags/Memory/" style="font-size: 15px;">Memory</a> <a href="/tags/Cookie/" style="font-size: 15px;">Cookie</a> <a href="/tags/Session/" style="font-size: 15px;">Session</a> <a href="/tags/Http/" style="font-size: 15px;">Http</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-bar-chart"> 访客统计</i></div><a href="https://s05.flagcounter.com/more/quj"><img src="https://s05.flagcounter.com/count2/quj/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_10/viewers_0/labels_1/pageviews_1/flags_0/percent_0/" alt="Since 2016.04.28" border="0" style="margin-top:15px;"></a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">墨言.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" href="https://jverson.com"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.1" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.1" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.1"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.1"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.1"></script></div></body></html>